#! /bin/bash
source settings.shinclude
source bin/management.shinclude

cd "${LILY_HOME}"

echo "Rebuild to these indexes requested: ${INDEXES}"
echo -n "Proceed?"
need_confirm

for index in $INDEXES; do
    name="${index%%:*}"
    host="${index#*:}"

    echo "Rebuild index '${name}' (host: ${host})?"
    ./bin/lily-update-index \
        --zookeeper "${ZOOKEEPER_HOST}" \
        --name "${name}" \
        --build-state "BUILD_REQUESTED"

    echo "rebuilding..."

done
