#! /usr/bin/env python2.6

import sys

from lily import LilyRepo


def main(arguments):
    if len(arguments) < 3:
        print("usage: %s LILY_BASE_URL FROM_ID [EXCLUSIVE_TO_ID]" % arguments[0])
        sys.exit(1)
    lily_base_url = arguments[1]
    from_id = int(arguments[2])
    to_id = from_id + 1
    if len(arguments) == 4:
        to_id = int(arguments[3])

    if to_id - from_id > 1:
        print("Delete bugs %s (inclusive) to %s (exclusive)? (Enter 'Yes')" % (from_id, to_id))
        if raw_input() != 'Yes':
            print("Cancelled by user.")
            sys.exit(1)

    repo = LilyRepo(lily_base_url)
    for id in xrange(from_id, to_id):
        repo.delete(id)
        print("")

    print("To make index changes visible, run: bin/index_commit .")
    print("To re-import (after compaction):    bin/import %s %s" % (from_id, to_id))



if __name__ == "__main__":
    main(sys.argv)

