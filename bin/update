#! /bin/bash
project_dir=$(dirname "${0}")/..
cd "${project_dir}"
source settings.shinclude

FROM_ID=$1
TO_ID=$2

if [ "$1" == "" ]; then
    FROM_ID=1
    TO_ID=900900999
fi

echo "FROM: ${FROM_ID}, TO: ${TO_ID}"

mkdir -p ./log/update/

JAVAMAXMEM=2048 "${KETTLE_LIBS}/../kitchen.sh" \
        -file "${ETL_HOME}/jobs/update.kjb" \
        -param:"FROM_ID=${FROM_ID}" \
        -param:"TO_ID=${TO_ID}" \
        -param:"MAX_CF_ID=${MAX_CF_ID}" \
        -param:"ES_NODES=${ES_NODES}" \
        -param:"ES_CLUSTER=${ES_CLUSTER}" \
    >> "${ETL_HOME}/log/update/stdout" \
    2>> "${ETL_HOME}/log/update/stderr" || exit 1
